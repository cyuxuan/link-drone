# 016-实名及资质认证主流程

参考《无人机供需撮合平台技术方案文档_v1》，本流程覆盖个人/企业实名与资质认证的业务主路径，确保平台合规与供给方准入质量。

## 1. 目标与范围
- 完成个人/企业主体的实名认证与资质核验（执照、飞手证、设备证书）。
- 建立“自动初筛 + 人工复审”的双轨机制，保障效率与准确性。
- 与供给发布、订单履约、资金结算流程打通（资质为前置条件）。

## 2. 参与角色
- 用户（供给方/需求方）：提交实名与资质材料。
- 审核员（运营）：复核材料、裁决通过/驳回、维护黑白名单。
- 系统：OCR/活体检测/三方数据源比对，生成审核事件。

## 3. 前置条件
- 对接 OCR/活体检测服务，存储加密合规（私密材料隔离存储）。
- 配置认证项与有效期规则（到期提醒与再认证）。
- 审核工作台与审计链路可用。

## 4. 主流程
1) 提交材料
- 用户在认证页选择主体类型（个人/企业），按指引上传证件与资质照片/PDF。
- 系统进行自动初筛：OCR、版式/清晰度、字段合理性（姓名/证件号/有效期）。

2) 自动初筛
- 通过：进入人工复审队列，状态 `reviewing`。
- 不通过：返回问题点（模糊、缺页、信息不匹配），状态 `resubmit_required`。

3) 人工复审
- 审核员在工作台核对材料与三方数据源；必要时发起电话/视频复核。
- 审核结果：`approved` 或 `rejected`，记录理由与证据，支持申诉。

4) 生效与维护
- 通过后更新用户资质状态，写入缓存与搜索索引（供需匹配可用）。
- 资质到期前 T-30/T-7/T-1 发提醒；到期自动降级至 `expired` 状态，限制相关业务操作。

## 5. 状态与事件
- 认证状态：`none` → `draft` → `reviewing` → `approved/rejected` → `expired`。
- 事件：`KycSubmitted`、`KycAutoScreened`、`KycReviewed`、`KycApproved/Rejected`、`KycExpired`。

## 6. 接口映射（示例）
- `POST /api/kyc/submit` 提交认证材料
- `GET  /api/kyc/status` 查询认证状态
- `POST /api/kyc/review/{id}` 审核裁决（管理员）
- `POST /api/kyc/resubmit` 驳回后重新提交

## 7. 数据与校验
- 数据模型：`user_kyc`、`user_certifications`（类型、编号、有效期、附件）、审计表。
- 校验规则：姓名/主体一致性、证件号格式、有效期、企业信息工商对照，风险名单比对。
- 隐私与合规：附件加密、访问授权控制、留痕不可篡改、最小化采集与使用。

## 8. 异常与回滚
- 材料不全/不清晰：提示具体缺陷，保留草稿状态与断点续传。
- 三方服务失败：自动降级为人工复核，记录失败原因与次数。
- 到期未续：自动下线相关供给项，订单创建前校验拦截。

## 9. 审计与合规
- 审计字段：提交者、时间、材料变更、裁决者、理由、证据链（哈希指纹）。
- 合规：个人信息保护、资质信息加密存储、访问最小化；支持合规导出与删除。

## 10. 验收标准
- 认证提交-通过/驳回-申诉闭环用例完整覆盖。
- 自动初筛准确率与复审效率达标（误判率 < 2%，平均复审 < 10 分钟）。
- 与供给发布/订单等流程联动前置校验可用（未认证拦截）。