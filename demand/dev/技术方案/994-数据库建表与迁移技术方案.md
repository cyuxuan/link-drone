# 数据库建表与迁移技术方案

## 目标
- 以迁移脚本驱动的方式管理数据库结构演进，保障多环境一致性与可回滚。

## 技术选型
- `Flyway`（优先）或 `Liquibase`；`MySQL` 作为主存储。

## 组织结构
- `drone-system-*/src/main/resources/db/migration` 存放版本脚本。
- 命名约定：`V<version>__<desc>.sql`，如 `V1__init_user_table.sql`。

## 基础表（示例）
- 用户/角色/权限、供给/需求、订单/支付、文件元数据、消息消费位点。
- 审计字段：`created_at/updated_at/created_by/updated_by`，统一时区。

## 迁移流程
1. 开发编写脚本；本地验证。
2. CI 环境执行迁移；失败自动回滚并报警。
3. 生产灰度发布：备份+只前滚策略。

## 对齐与规范
- 严禁手工改库；所有变更需通过迁移脚本。
- 字段命名统一、索引与外键规范；数值类型与精度统一。

## 验收标准
- 各服务启动时能自动完成迁移；多环境结构一致。